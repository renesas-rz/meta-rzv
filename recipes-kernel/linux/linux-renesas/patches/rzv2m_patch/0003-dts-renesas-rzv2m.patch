From 50058202000fcad777c1a910fe4332bae733acc7 Mon Sep 17 00:00:00 2001
From: Loc Vu <loc.vu.zn@renesas.com>
Date: Fri, 10 Sep 2021 14:52:45 +0700
Subject: [PATCH] dts-renesas-rzv2m

Signed-off-by: Loc Vu <loc.vu.zn@renesas.com>
---
 .../dts/renesas/r9a09g011gbg-evaluation-board.dts  |  75 ++++++
 arch/arm64/boot/dts/renesas/r9a09g011gbg.dtsi      | 263 +++++++++++++++++++++
 2 files changed, 338 insertions(+)
 create mode 100644 arch/arm64/boot/dts/renesas/r9a09g011gbg-evaluation-board.dts
 create mode 100644 arch/arm64/boot/dts/renesas/r9a09g011gbg.dtsi

diff --git a/arch/arm64/boot/dts/renesas/r9a09g011gbg-evaluation-board.dts b/arch/arm64/boot/dts/renesas/r9a09g011gbg-evaluation-board.dts
new file mode 100644
index 0000000..c998b91
--- /dev/null
+++ b/arch/arm64/boot/dts/renesas/r9a09g011gbg-evaluation-board.dts
@@ -0,0 +1,75 @@
+// SPDX-License-Identifier: GPL-2.0
+/*
+ * Device Tree Source for the RZ/V2M RDK platform
+ *
+ * Copyright (C) 2019 Renesas Electronics Corp.
+ */
+
+/dts-v1/;
+#include "r9a09g011gbg.dtsi"
+#include <dt-bindings/gpio/gpio.h>
+
+/ {
+       model = "RZ/GV2M RDK platform";
+       compatible = "renesas,evaluation-board", "renesas,r9a09g011gbg";
+
+       aliases {
+
+       };
+
+       chosen {
+               bootargs = "earlycon=uart,mmio32,0xA4040000,115200n8 console=ttyS0,115200n8 ignore_loglevel vmalloc=384M root=/dev/mmcblk1p3 rootwait rootfstype=ext3 rw; rodata=off";
+               stdout-path = "uart0:115200n8";
+       };
+
+       memory@08000000 {
+               device_type = "memory";
+               /* first 256MB is reserved for secure area. */
+               reg = <0x00000000 0x10000000 0x0 0x70000000>;
+       };
+
+#if 1 /*  */
+       reserved-memory {
+               #address-cells = <2>;
+               #size-cells = <2>;
+               ranges;
+
+               /* global autoconfigured region for contiguous allocations */
+               linux,cma@18000000 {
+                       compatible = "shared-dma-pool";
+                       reusable;
+                       reg = <0x00000000 0x18000000 0x0 0x10000000>;
+                       linux,cma-default;
+               };
+
+               /* device specific region for contiguous allocations */
+               drp_reserved: linux,CMAtoDRP {
+                       compatible = "shared-dma-pool";
+                       reusable;
+                       reg = <0x00000000 0x28000000 0x0 0x08000000>;
+               };
+       };
+#endif
+
+       mmngr {
+               compatible = "renesas,mmngr";
+/*             memory-region = <&mmp_reserved>; */
+       };
+
+       mmngrbuf {
+               compatible = "renesas,mmngrbuf";
+       };
+};
+
+#if 1 /* used cpg(clock pulse generator) */
+&extal_clk {
+       clock-frequency = <48000000>;
+};
+#endif
+
+#if 0 /* used watch dog timer */
+&rwdt {
+       status = "okay";
+       timeout-sec = <60>;
+};
+#endif
diff --git a/arch/arm64/boot/dts/renesas/r9a09g011gbg.dtsi b/arch/arm64/boot/dts/renesas/r9a09g011gbg.dtsi
new file mode 100644
index 0000000..d4f66c1
--- /dev/null
+++ b/arch/arm64/boot/dts/renesas/r9a09g011gbg.dtsi
@@ -0,0 +1,263 @@
+// SPDX-License-Identifier: GPL-2.0
+/*
+ * Device Tree Source for the RZ/V2M (R9A09G011GBG) SoC
+ *
+ * Copyright (C) 2019 Renesas Electronics Corp.
+ */
+
+#include <dt-bindings/clock/r9a09g011gbg-cpg-mssr.h>
+#include <dt-bindings/interrupt-controller/arm-gic.h>
+#include <dt-bindings/power/r9a09g011gbg-sysc.h>
+
+/ {
+       compatible = "renesas,r8arzv2m";
+       #address-cells = <2>;
+       #size-cells = <2>;
+
+       aliases {
+               ethernet0 = &avb;
+       };
+
+#if 1 /* used cpu */
+       cpus {
+               #address-cells = <1>;
+               #size-cells = <0>;
+
+               a53_0: cpu@0 {
+                       compatible = "arm,cortex-a53", "arm,armv8";
+                       reg = <0>;
+                       device_type = "cpu";
+                       #power-domains = <&sysc R8A774C0_PD_CA53_CPU0>;
+                       next-level-cache = <&L2_CA53>;
+                       enable-method = "psci";
+                       #cooling-cells = <2>;
+                       dynamic-power-coefficient = <277>;
+                       cooling-min-level = <0>;
+                       cooling-max-level = <2>;
+                       cpu-idle-states = <&CPU_SLEEP_1>;
+                       clocks = <&cpg CPG_CORE R8A774C0_CLK_Z2>;
+               };
+
+               L2_CA53: cache-controller-0 {
+                       compatible = "cache";
+                       power-domains = <&sysc R8A774C0_PD_CA53_SCU>;
+                       cache-unified;
+                       cache-level = <2>;
+               };
+
+               idle-states {
+                       entry-method = "psci";
+
+                       CPU_SLEEP_1: cpu-sleep-1 {
+                               compatible = "arm,idle-state";
+                               arm,psci-suspend-param = <0x0010000>;
+                               local-timer-stop;
+                               entry-latency-us = <700>;
+                               exit-latency-us = <700>;
+                               min-residency-us = <5000>;
+                               status = "okay";
+                       };
+               };
+       };
+#endif
+
+#if 1 /* used cpg(clock pulse generator) */
+       extal_clk: extal {
+               compatible = "fixed-clock";
+               #clock-cells = <0>;
+               /* This value must be overridden by the board */
+               clock-frequency = <0>;
+       };
+       imclk: imclk@200M {
+               #clock-cells = <0>;
+               compatible = "fixed-clock";
+               clock-frequency = <200000000>;
+       };
+#endif
+
+       soc: soc {
+               compatible = "simple-bus";
+               interrupt-parent = <&gic>;
+               #address-cells = <2>;
+               #size-cells = <2>;
+               ranges;
+
+#if 0 /* used watch dog timer */
+               rwdt: watchdog@e6020000 {
+                       compatible = "renesas,r8a774c0-wdt",
+                                    "renesas,rcar-gen3-wdt";
+                       reg = <0 0xe6020000 0 0x0c>;
+                       clocks = <&cpg CPG_MOD 402>;
+                       power-domains = <&sysc R8A774C0_PD_ALWAYS_ON>;
+                       resets = <&cpg 402>;
+                       status = "disabled";
+               };
+#endif
+
+#if 1 /* used sh card boot */
+               pfc: pin-controller@B6250000 {
+                       compatible = "renesas,pfc-r8a774c0";
+                       reg = <0 0xB6250000 0 0x2>;
+               };
+#endif
+
+#if 1 /* used soc systems */
+               cpg: clock-controller@A3500000 {
+                       compatible = "renesas,r8arzv2m-cpg-mssr";
+                       reg = <0 0xA3500000 0 0x4>;
+                       clocks = <&extal_clk>;
+                       clock-names = "extal";
+                       #clock-cells = <2>;
+                       #power-domain-cells = <0>;
+                       #reset-cells = <1>;
+               };
+
+               sysc: system-controller@A3F03000 {
+                       compatible = "renesas,r8arzv2m-sysc";
+                       reg = <0 0xA3F03000 0 0x01>;
+                       #power-domain-cells = <1>;
+               };
+#endif
+
+#if 1 /* used sh card boot */
+               /* SDHI Setting */
+               mmc1: sdhi@85000000 {
+                       compatible = "renesas,sdhi-r8a774c0",
+                                    "renesas,rcar-gen3-sdhi";
+                       reg = <0 0x85000000 0 0x2000>;
+                       interrupts = <0 170 IRQ_TYPE_LEVEL_LOW>,
+                                        <0 171 IRQ_TYPE_LEVEL_LOW>,
+                                        <0 101 IRQ_TYPE_LEVEL_HIGH>; /* EXT_GIO_INT[1] */
+                       clocks = <&imclk>;
+                       cap-sd-highspeed;
+                       cap-mmc-highspeed;
+                       sd-uhs-sdr104;
+                       sd-uhs-sdr50;
+                       mmc-hs200-1_8v;
+                       bus-width = <1>;
+                       cap-sdio-irq;
+                       renesas,mmc-scc-tapnum = <8>;
+                       renesas,mmc-scc-tappos=<0x0401>;
+                       max-frequency = <200000000>;
+                       #stream-id_cells = <1>;
+
+                       #address-cells = <2>;
+                       #size-cells = <2>;
+                       ranges;
+               };
+#endif
+
+#if 1 /* used soc systems */
+               gic: interrupt-controller@82000000 {
+                       compatible = "arm,gic-400";
+                       #interrupt-cells = <3>;
+                       #address-cells = <0>;
+                       interrupt-controller;
+                       reg = <0x0 0x82010000 0 0x1000>,
+                             <0x0 0x82020000 0 0x20000>,
+                             <0x0 0x82040000 0 0x20000>,
+                             <0x0 0x82060000 0 0x20000>;
+                       interrupts = <GIC_PPI 9
+                                       (GIC_CPU_MASK_SIMPLE(2) | IRQ_TYPE_LEVEL_HIGH)>;
+                       clocks = <&cpg CPG_MOD 408>;
+                       clock-names = "clk";
+                       power-domains = <&sysc R8A774C0_PD_ALWAYS_ON>;
+                       resets = <&cpg 408>;
+               };
+#endif
+
+#if 1
+               uart0@a4040000 {
+                       compatible = "renesas,rzv2m-16750", "ns16750";
+                       reg = <0x00 0xA4040000 0x00 0x80>;
+                       interrupts = <GIC_SPI 179 IRQ_TYPE_LEVEL_HIGH>;
+                       clock-frequency = <48000000>;
+                       reg-shift = <2>;
+                       reg-io-width = <4>;
+                       status = "okay";
+#if 0
+                       dmas = <&dma1 0 (NBPF_SLAVE_RQ_HIGH | NBPF_SLAVE_RQ_LEVEL)
+                                       &dma1 1 (NBPF_SLAVE_RQ_HIGH | NBPF_SLAVE_RQ_LEVEL)>;
+                       dma-names = "tx","rx";
+#endif
+               };
+
+               uart1@a4040080 {
+                       compatible = "renesas,espada-16750", "ns16750";
+                       reg = <0x00 0xA4040080 0x00 0x80>;
+                       interrupts = <GIC_SPI 180 IRQ_TYPE_LEVEL_HIGH>;
+                       clock-frequency = <48000000>;
+                       reg-shift = <2>;
+                       reg-io-width = <4>;
+                       status = "okay";
+#if 0
+                       dmas = <&dma1 2 (NBPF_SLAVE_RQ_HIGH | NBPF_SLAVE_RQ_LEVEL)
+                                       &dma1 3 (NBPF_SLAVE_RQ_HIGH | NBPF_SLAVE_RQ_LEVEL)>;
+                       dma-names = "tx","rx";
+#endif
+               };
+
+               avb: ethernet@a3300000 {
+                       compatible = "renesas,etheravb-r8arzv2m",
+                                    "renesas,etheravb-rcar-gen3";
+                       reg = <0 0xa3300000 0 0x800>;
+                       interrupts = <GIC_SPI 39 IRQ_TYPE_LEVEL_HIGH>,
+                                    <GIC_SPI 40 IRQ_TYPE_LEVEL_HIGH>,
+                                    <GIC_SPI 41 IRQ_TYPE_LEVEL_HIGH>,
+                                    <GIC_SPI 42 IRQ_TYPE_LEVEL_HIGH>,
+                                    <GIC_SPI 43 IRQ_TYPE_LEVEL_HIGH>,
+                                    <GIC_SPI 44 IRQ_TYPE_LEVEL_HIGH>,
+                                    <GIC_SPI 45 IRQ_TYPE_LEVEL_HIGH>,
+                                    <GIC_SPI 46 IRQ_TYPE_LEVEL_HIGH>,
+                                    <GIC_SPI 47 IRQ_TYPE_LEVEL_HIGH>,
+                                    <GIC_SPI 48 IRQ_TYPE_LEVEL_HIGH>,
+                                    <GIC_SPI 49 IRQ_TYPE_LEVEL_HIGH>,
+                                    <GIC_SPI 50 IRQ_TYPE_LEVEL_HIGH>,
+                                    <GIC_SPI 51 IRQ_TYPE_LEVEL_HIGH>,
+                                    <GIC_SPI 52 IRQ_TYPE_LEVEL_HIGH>,
+                                    <GIC_SPI 53 IRQ_TYPE_LEVEL_HIGH>,
+                                    <GIC_SPI 54 IRQ_TYPE_LEVEL_HIGH>,
+                                    <GIC_SPI 55 IRQ_TYPE_LEVEL_HIGH>,
+                                    <GIC_SPI 56 IRQ_TYPE_LEVEL_HIGH>,
+                                    <GIC_SPI 57 IRQ_TYPE_LEVEL_HIGH>,
+                                    <GIC_SPI 58 IRQ_TYPE_LEVEL_HIGH>,
+                                    <GIC_SPI 59 IRQ_TYPE_LEVEL_HIGH>,
+                                    <GIC_SPI 60 IRQ_TYPE_LEVEL_HIGH>,
+                                    <GIC_SPI 61 IRQ_TYPE_LEVEL_HIGH>,
+                                    <GIC_SPI 62 IRQ_TYPE_LEVEL_HIGH>,
+                                    <GIC_SPI 63 IRQ_TYPE_LEVEL_HIGH>;
+                       interrupt-names = "ch0", "ch1", "ch2", "ch3",
+                                         "ch4", "ch5", "ch6", "ch7",
+                                         "ch8", "ch9", "ch10", "ch11",
+                                         "ch12", "ch13", "ch14", "ch15",
+                                         "ch16", "ch17", "ch18", "ch19",
+                                         "ch20", "ch21", "ch22", "ch23",
+                                         "ch24";
+                       clocks = <&cpg CPG_MOD 812>;
+                       power-domains = <&sysc R8A774C0_PD_ALWAYS_ON>;
+                       resets = <&cpg 812>;
+                       renesas,no-ether-link;
+                       phy-handle = <&phy0>;
+                       phy-mode = "gmii";
+                       #address-cells = <1>;
+                       #size-cells = <0>;
+                       status = "okay";
+
+                       phy0: ethernet-phy@0 {
+                               rxc-skew-ps = <1500>;
+                               reg = <0>;
+                               interrupts = <21 IRQ_TYPE_LEVEL_LOW>;
+                       };
+               };
+
+#endif
+       };
+
+       timer {
+               compatible = "arm,armv8-timer";
+               interrupts-extended = <&gic GIC_PPI 13 (GIC_CPU_MASK_SIMPLE(2) | IRQ_TYPE_LEVEL_LOW)>,
+                                     <&gic GIC_PPI 14 (GIC_CPU_MASK_SIMPLE(2) | IRQ_TYPE_LEVEL_LOW)>,
+                                     <&gic GIC_PPI 11 (GIC_CPU_MASK_SIMPLE(2) | IRQ_TYPE_LEVEL_LOW)>,
+                                     <&gic GIC_PPI 10 (GIC_CPU_MASK_SIMPLE(2) | IRQ_TYPE_LEVEL_LOW)>;
+       };
+};
-- 
2.7.4

